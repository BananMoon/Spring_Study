## 어쩌다 JDBC가 등장했는가?
애플리케이션을 개발할 때 중요한 데이터는 대부분 데이터베이스에 보관한다.
그리고 클라이언트(app, web)는 애플리케이션 서버를 이용해서 데이터를 저장/조회한다.
이때 일련의 과정을 거친다.
1. 주로 TCP/IP를 사용해서 DB와 커넥션을 연결한다.
2. DB가 이해할 수 있는 SQL을 커넥션을 통해 DB에 전달한다.
3. DB는 전달된 SQL을 수행하고 결과를 애플리케이션 서버로 응답한다.

위 과정이 MySQL DB일 때 Oracle DB일 때마다.. 즉 데이터베이스를 다른 종류로 변경할 때마다,
1. 애플리케이션 서버에 개발된 DB 사용 코드도 함께 변경해야 한다.
2. 개발자가 DB 종류 별 커넥션 연결 ~ 결과를 응답받는 방법을 새로 학습해야 한다.

이러한 문제를 해결하고자 JDBC라는 자바 표준이 등장한 것이다.
<br>

## JDBC가 뭐지?
Java DataBase Connectivity (JDBC)는 자바에서 데이터베이스에 접속할 수 있도록 해주는 자바 API이다. 
JDBC는 데이터베이스에서 자료를 쿼리/업데이트하는 것을 손쉽게 하는 방법을 제공한다.

아래 3가지 기능을 표준 인터페이스로 정의해서 제공하는데,
- `java.sql.Connection` - 커넥션 연결
- `java.sql.Statement` - SQL 쿼리를 담은 내용
- `java.sql.ResultSet` - SQL 요청 응답 (결과)
<br>

## JDBC 드라이버
이제 개발자는 표준 인터페이스만 사용해서 개발하면 되는데, <br>
기능이 동작하려면 당연히 이 JDBC 인터페이스를 각 DB에 맞도록 구현한 라이브러리가 있어야 한다.<br>
즉, JDBC 표준 인터페이스를 상속(extends)받는 구현체가 있어야하고 이것을 JDBC 드라이버라고 한다.

- ex) Oracle DB에 접근할 수 있기 위해 Oracle JDBC 드라이버를 사용해야 한다.
- 개발자는 JDBC 표준 인터페이스 사용법만 학습해 놓으면, 추가로 수정 및 학습하지 않아도 JDBC 구현 라이브러리를 변경할 수 있다.

어느정도 표준화가 되었지만 그럼에도 각각 DB마다 SQL, 데이터 타입 등은 일부 다르다.<br>
대표적으로 페이징 SQL인데, DB를 변경하면 JDBC 코드는 변경하지 않아도 되지만 SQL은 해당 DB에 맞게 다른 SQL을 정의해야 한다.
> JPA(Java Persistence API)가 이 문제 또한 많은 부분 해결해준다.

### JDBC 드라이버를 사용하는 세가지 방법
1. JDBC 직접 사용

애플리케이션 로직에서 JDBC를 통해 SQL을 직접 전달한다.

2. SQL Mapper

JDBC를 직접적으로 사용하는게 아닌, 편리하게 사용하도록 중간에서 도와준다.<br>
대표적으로 JdbcTemplate, MyBatis 2가지가 있다.
```
장점
- SQL 응답 결과를 객체로 편리하게 변환해준다. (1번은 직접 변환했어야 했다)
- JDBC 사용을 위한 반복 코드를 제거해준다.

단점
- 개발자가 SQL을 직접 작성해야하는 번거로움이 있다.
```


3. ORM 기술<br>
객체를 관계형 DB 테이블과 매핑해주는 기술이다.<br>
대표적으로 자바 진영의 ORM 표준 **인터페이스**가 JPA이고, 이를 **구현**한 것이 하이버네이트, 이클립스 링크 등이 있다.

```
동작 방식
- 개발자가 쿼리를 작성해서 전달하는게 아닌, **객체**를 JPA에게 전달한다.
- JPA(구현체)는 전달받은 객체의 매핑(mapping) 정보를 보고 쿼리를 동적으로 생성 및 실행해준다.
	- 이때 각 DB마다 다른 SQL을 사용하는 문제도 해결한다.<br>
```

> SQL Mapper와 ORM 기술로 인해 개발자는 JDBC를 직접 사용하지 않지만, 이런 기술들도 내부에서 모두 JDBC를 사용하기 때문에, JDBC가 어떻게 동작하는지 기본 원리를 알아두어야 한다.
> 무엇보다 문제가 발생했을 때 근본적인 문제를 찾아서 해결할 수 있기 때문에, JDBC는 자바 개발자라면 꼭 알아두어야하는 필수 기본 기술이다.
<br>

## 데이터베이스 연결
현재 프로젝트에서 JDBC를 연결해서 테스트를 해보아도 h2가 제공하는 JDBC를 사용하고 있는 것을 알 수 있다.(해당 [테스트](https://github.com/BananMoon/Spring_Study/blob/main/Spring-DB/jdbc/src/test/java/springdb1/jdbc/connection/DBConnectionUtilTest.java)를 실행하면 로그에 나온다.)>br?
h2 접근 url 기반으로, JDBC Connection의 구현체인 h2 JDBC Driver가 사용되는 것이다.<br>
아래 클래스는 h2 패키지 내에 있는 `JDBCConnection` 클래스이다. 해당 클래스도 `java.sql`의 `Connection` 인터페이스를 구현하고 있는 것을 확인할 수 있다.
![image](https://user-images.githubusercontent.com/66311276/204144395-7a1c0a0a-deff-42c5-9545-ac8cb1416b4f.png)


요청된 SQL문이 DB로 어떻게 전달이 될까? 과정은 아래와 같다.
1. 애플리케이션에서 연결 요청을 하면 JDBC가 제공하는 `DriverManager`의 `getConnection()`이 호출된다. 이때 URL 정보와 접속에 필요한 추가정보들도 함께 전달된다.
DriverManager는 라이브러리에 등록된 드라이버 목록들을 자동으로 인식하는데,
2. 이 드라이버들에게 정보를 함께 넘기면서 DB 커넥션 획득이 가능한지 확인한다.
3. 드라이버들 중 본인이 처리할 수 있는 구현체의 경우 커넥션을 획득해서 클라이언트에게 반환한다.
